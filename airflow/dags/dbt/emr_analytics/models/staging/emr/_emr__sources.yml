version: 2

sources:
  - name: emr        
    database: "{{ env_var('ANALYTICS_BQ_PROJECT_ID') }}"
    schema: "{{ env_var('ANALYTICS_BQ_DATASET') }}"
    tables:
      - name: raw_patients
        description: "Raw patient data from Synthea in GCS"
        external:
          location: "gs://{{ env_var('TRANSFORMATION_GCS_BUCKET_DESTINATION') }}/{{ env_var('TRANSFORMATION_GCS_BUCKET_DESTINATION_PREFIX') }}/patients/*"
          options:
            format: "PARQUET"
            hive_partition_uri_prefix: "gs://{{ env_var('TRANSFORMATION_GCS_BUCKET_DESTINATION') }}/{{ env_var('TRANSFORMATION_GCS_BUCKET_DESTINATION_PREFIX') }}/patients/"
            uris:
              - "gs://{{ env_var('TRANSFORMATION_GCS_BUCKET_DESTINATION') }}/{{ env_var('TRANSFORMATION_GCS_BUCKET_DESTINATION_PREFIX') }}/patients/*"